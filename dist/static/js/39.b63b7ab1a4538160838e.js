webpackJsonp([39,48],{378:function(e,t,o){var r=o(2)(o(707),o(430),null,null);e.exports=r.exports},430:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",[o("el-col",{staticClass:"toolbar",attrs:{span:24}},[o("el-form",{attrs:{inline:!0}},[o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.roleAdd}},[e._v("新增角色")])],1)],1)],1),e._v(" "),[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{stripe:"",data:e.roleList}},[o("el-table-column",{attrs:{type:"index",width:"100",label:"序号"}}),e._v(" "),o("el-table-column",{attrs:{label:"角色类型",prop:"roleName"}},[e._v(">")]),e._v(" "),o("el-table-column",{attrs:{label:"备注说明",prop:"roleRemark"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:{default:function(t){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){e.roleEdit(t.row)}}},[e._v("编辑权限")]),e._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){e.roleDel(t.row)}}},[e._v("删除")])]}}})],1)],e._v(" "),o("el-col",{staticClass:"toolbar",attrs:{span:24}},[o("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total,prev, pager, next,jumper",total:e.total},on:{"current-change":e.roleCurrentChange}})],1),e._v(" "),o("el-dialog",{directives:[{name:"model",rawName:"v-model",value:e.editFormAdd,expression:"editFormAdd"}],attrs:{title:"新增角色"},domProps:{value:e.editFormAdd},on:{close:e.editCancel,input:function(t){e.editFormAdd=t}}},[o("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"120px",rules:e.editFormRules}},[o("el-form-item",{attrs:{label:"角色类型名称",prop:"role_name"}},[o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.editForm.role_name,expression:"editForm.role_name"}],attrs:{"auto-complete":"off"},domProps:{value:e.editForm.role_name},on:{input:function(t){e.editForm.role_name=t}}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注说明",prop:"role_remark"}},[o("el-input",{directives:[{name:"model",rawName:"v-model",value:e.editForm.role_remark,expression:"editForm.role_remark"}],attrs:{"auto-complete":"off"},domProps:{value:e.editForm.role_remark},on:{input:function(t){e.editForm.role_remark=t}}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",slot:"footer"},[o("el-button",{on:{click:e.editCancel}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary "},on:{click:e.AddSumbit}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{directives:[{name:"model",rawName:"v-model",value:e.editFormVisible,expression:"editFormVisible"}],attrs:{title:"编辑权限"},domProps:{value:e.editFormVisible},on:{close:e.editCancel,input:function(t){e.editFormVisible=t}}},[[o("el-tree",{ref:"tree",attrs:{data:e.arr,"show-checkbox":"","default-expand-all":"","node-key":"powerId",props:e.defaultProps,"default-checked-keys":e.power}})],e._v(" "),o("div",{staticClass:"dialog-footer",slot:"footer"},[o("el-button",{on:{click:e.editCancel}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary "},on:{click:e.editSumbit}},[e._v("确 定")])],1)],2)],2)},staticRenderFns:[]}},707:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(64),l=r(i),a=o(5),n=r(a);t.default={data:function(){return{roleList:[],powerList:[],pageSize:10,pageNum:1,total:0,listLoading:!1,editFormVisible:!1,editFormTtile:"编辑",checkAll:!1,roleId:"",editFormAdd:!1,editForm:{role_name:"",role_remark:""},editFormRules:{role_name:[{required:!0,message:"请填写角色类型",trigger:"blur"}],role_remark:[{required:!0,message:"请填写备注说明",trigger:"blur"}]},arr:[],power:[],defaultProps:{children:"children",label:"powerName"}}},mounted:function(){this.getRoleList(),this.getPowerList()},methods:{getPowerFirst:function(){for(var e=[],t=0;t<this.powerList.length;t++)0===this.powerList[t].powerPid&&e.push({powerId:this.powerList[t].powerId,powerName:this.powerList[t].powerName});this.getPowerSecond(e)},getPowerSecond:function(e){for(var t=[],o=0;o<e.length;o++){t=[];for(var r=0;r<this.powerList.length;r++)this.powerList[r].powerPid===e[o].powerId&&t.push({powerId:this.powerList[r].powerId,powerName:this.powerList[r].powerName});e[o]=(0,l.default)(e[o],{children:t})}this.getPowerThird(e)},getPowerThird:function(e){for(var t=[],o=0;o<e.length;o++)for(var r=0;r<e[o].children.length;r++){t=[];for(var i=0;i<this.powerList.length;i++)this.powerList[i].powerPid===e[o].children[r].powerId&&t.push({powerId:this.powerList[i].powerId,powerName:this.powerList[i].powerName});e[o].children[r]=(0,l.default)(e[o].children[r],{children:t})}this.arr=e},getRoleList:function(){var e=this;n.default.post({ext:"system/role/page",pageNum:this.pageNum,pageSize:this.pageSize}).then(function(t){e.roleList=t.data.data.list,e.total=t.data.data.total}),this.listLoading=!1},getPowerList:function(){var e=this;n.default.get({ext:"system/power/readList"}).then(function(t){e.powerList=t.data.data}),setTimeout(function(){e.getPowerFirst()},500)},roleEdit:function(e){var t=this;this.roleId=e.roleId,this.power=[],n.default.get({ext:"system/role/power/readList",role_id:e.roleId}).then(function(e){for(var o=e.data.data,r=0;r<o.length;r++)t.power.push(o[r].powerId);console.log(t.power)}),setTimeout(function(){t.editFormVisible=!0,t.editFormTtile="编辑权限"},100)},roleAdd:function(){this.editFormAdd=!0,this.editForm={role_name:"",role_remark:""}},AddSumbit:function(){var e=this;this.$refs.editForm.validate(function(t){return t?void n.default.post({ext:"system/role/add",role_name:e.editForm.role_name,role_remark:e.editForm.role_remark}).then(function(){e.editFormAdd=!1,e.listLoading=!0,e.getRoleList()}).catch(function(){}):(e.$alert("信息填写不完整!","提示",{confirmButtonText:"确定"}).catch(function(){}),!1)})},roleDel:function(e){var t=this;this.$confirm("您确定要删除该角色","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){n.default.post({ext:"system/role/delete",ids:e.roleId}).then(function(e){t.$notify({title:"成功",message:"操作成功",type:"success"}),t.listLoading=!0,t.getRoleList()})}).catch(function(){})},powerCheckedChange:function(e){},editSumbit:function(){var e=this;this.editFormVisible=!1;var t=this.$refs.tree.getCheckedKeys().join(",");n.default.put({ext:"system/role/power/edit",role_id:this.roleId,power_id:t}).then(function(t){e.$notify({title:"成功",message:"操作成功",type:"success"}),e.listLoading=!0,e.getRoleList()})},editCancel:function(){this.editFormVisible=!1},roleCurrentChange:function(e){this.pageNum=e,this.getRoleList(this.pageNum)}}}}});
//# sourceMappingURL=39.b63b7ab1a4538160838e.js.map